<!DOCTYPE html>
<html lang="en">
  <head>

  <style>
    /*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}.highlight{background:#f8f8f8;padding:1px 1em;border-radius:3px;font-size:1em;font-size:0.9em;overflow:auto;margin:1em -1em}.highlight .c{color:#999988;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#999988;font-style:italic}.highlight .cp{color:#999999;font-weight:bold}.highlight .c1{color:#999988;font-style:italic}.highlight .cs{color:#999999;font-weight:bold;font-style:italic}.highlight .gd{color:#000000;background-color:#ffdddd}.highlight .gd .x{color:#000000;background-color:#ffaaaa}.highlight .ge{font-style:italic}.highlight .gr{color:#aa0000}.highlight .gh{color:#999999}.highlight .gi{color:#000000;background-color:#ddffdd}.highlight .gi .x{color:#000000;background-color:#aaffaa}.highlight .go{color:#888888}.highlight .gp{color:#555555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaaaaa}.highlight .gt{color:#aa0000}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#445588;font-weight:bold}.highlight .m{color:#009999}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086B3}.highlight .nc{color:#445588;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne{color:#990000;font-weight:bold}.highlight .nf{color:#990000;font-weight:bold}.highlight .nn{color:#555555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbbbbb}.highlight .mf{color:#009999}.highlight .mh{color:#009999}.highlight .mi{color:#009999}.highlight .mo{color:#009999}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999999}.highlight .vc{color:#008080}.highlight .vg{color:#008080}.highlight .vi{color:#008080}.highlight .il{color:#009999}@font-face{font-family:"et-book";src:url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.eot");src:url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.eot?#iefix") format("embedded-opentype"),url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.woff") format("woff"),url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.ttf") format("truetype"),url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.svg#etbookromanosf") format("svg");font-weight:normal;font-style:normal;font-display:swap}@font-face{font-family:"et-book";src:url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.eot");src:url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.eot?#iefix") format("embedded-opentype"),url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.woff") format("woff"),url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.ttf") format("truetype"),url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.svg#etbookromanosf") format("svg");font-weight:normal;font-style:italic;font-display:swap}@font-face{font-family:"et-book";src:url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.eot");src:url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.eot?#iefix") format("embedded-opentype"),url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.woff") format("woff"),url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.ttf") format("truetype"),url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.svg#etbookromanosf") format("svg");font-weight:bold;font-style:normal;font-display:swap}@font-face{font-family:"et-book-roman-old-style";src:url("et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.eot");src:url("et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.eot?#iefix") format("embedded-opentype"),url("et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.woff") format("woff"),url("et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.ttf") format("truetype"),url("et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.svg#etbookromanosf") format("svg");font-weight:normal;font-style:normal;font-display:swap}body{background-color:#fffff8;box-sizing:content-box;font-family:Avenir;margin:0 auto;line-height:1.7;padding:4vh 6vw;overflow-x:hidden;color:#333;font-size:1rem;max-width:63em}@media (min-width: 820px){body{font-size:1.2rem}}time{display:block;color:#4d4d4d;margin:0.5em 0 1em}footer{margin:2em 0;font-size:0.8em;color:#5c5c5c;padding-top:1em}img{max-width:100%;display:block;margin:0 auto;max-height:75vh;border-radius:4px}blockquote{padding:1.5em;margin:0;font-size:0.88em;background:#f6f6f6;border-radius:4px}blockquote p{margin:0}hr{width:100%;border:0;height:1px;margin:1.5em 0;background:#d9d9d9}h1,h2,h3,h4,h5,h6{line-height:1.3;margin-bottom:0;padding-bottom:0}h1{font-weight:400;margin-top:4rem;margin-bottom:1.5rem;font-size:3.2rem;line-height:1}h2{font-weight:400;margin-top:2.1rem;margin-bottom:1.4rem;font-size:2.2rem;line-height:1}h3{font-weight:400;font-size:1.7rem;margin-top:2rem;margin-bottom:1.4rem;line-height:1}a{text-decoration:none;border-bottom:1px solid #d9d9d9;color:#3D78C5}a:hover{color:red !important;background:#fffaf1}a:after{position:relative;top:-0.5em;font-size:0.7em;content:"â†—";color:#3D78C5}a.internal-link:after{content:""}*:focus{background:#ffe8bc !important;color:black !important}nav{margin:1em 0 3em}ul{padding-left:0;list-style:none}ul li::before{content:"\2022";color:#3D78C5;font-weight:bold;display:inline-block;width:1em;margin-left:-1em}#notes-entry-container{display:grid;grid-gap:2em;grid-template-areas:"content" "side"}@media (min-width: 700px){#notes-entry-container{grid-template-columns:3fr 1fr;grid-template-areas:"content side"}}.backlink-box{background:#f6f6f6;padding:1em;border-radius:4px}code{background:#f5f5f5;padding:0.1em 0.2em;border-radius:4px}

  </style>

  <meta charset="UTF-8">

  <link rel="canonical" href="http://localhost:4000/typeface-dataset" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description" content="A dataset for Machine Learning experiment on Typefaces.">

  <meta property="og:site_name" content="Mohammed Ridwanul">

  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">


  <meta property="og:description" content="A dataset for Machine Learning experiment on Typefaces."/>



  <meta property="og:title" content="Typefaces - Character Font Image & CSV Dataset">
  <meta property="og:type" content="article">



  <meta property="article:published_time" content="2020-07-23T00:04:00-04:00">
  <meta property="article:author" content="http://localhost:4000/">


  <meta property="og:url" content="http://localhost:4000/typeface-dataset" />



  <title>

      Typefaces - Character Font Image & CSV Dataset &mdash; Mohammed Ridwanul

  </title>
</head>

  <body>
    <nav><div>
    <a class="internal-link" href="/"><b>Mohammed Ridwanul</b></a>
</div>
</nav>
    <div class="wrapper">
      <main><article>
  <div>
    <h1>Typefaces - Character Font Image & CSV Dataset</h1>
    <time datetime="2020-07-22T23:59:08-04:00">
      Last updated on July 22, 2020

    </time>
  </div>

  <div id="notes-entry-container">
    <content>
      <h4 id="a-dataset-for-machine-learning-experiment-on-typefaces">A dataset for Machine Learning experiment on Typefaces.</h4>

<p><em>Download:</em></p>
<ul>
  <li><a href="https://console.cloud.google.com/storage/browser/open-fonts-dataset/images">Fonts to Character-wise PNG (28x28), alphabets &amp; numbers only</a></li>
  <li><a href="https://console.cloud.google.com/storage/browser/open-fonts-dataset/csv">Character-wise PNGs (28x28) to CSV, alphabets &amp; numbers only</a></li>
</ul>

<hr />

<p>This is a dataset that consists of 2500+ fonts taken from the <a href="https://fonts.google.com/">Google Fonts</a> database that have been converted to character-wise PNGs and then flattened into a CSV for ML experiments.</p>

<p>I have only considered uppercase / lower case letters and numbers - ignoring other symbols or dingbats.</p>

<p>Each PNG is in greyscale (each pixel can take the value of 0 to 255)) 28x28 pixels in size.</p>

<p><img src="../assets/screenshot-fonts.png" alt="" /></p>

<p>The CSV is formatted similar to <a href="https://pjreddie.com/projects/mnist-in-csv/">MNIST in CSV</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>font-name, character, pix-11, pix-12, pix-13, ...
</code></pre></div></div>

<p><img src="../assets/screenshot-csv.png" alt="" /></p>

<hr />

<h3 id="bugs-built-something-cool">Bugs? Built something cool?</h3>

<p>Reach out <a href="https://twitter.com/mohammedri_">@mohammedri_</a></p>

<hr />

<p>Script to generate this dataset from <code class="highlighter-rouge">.ttf</code> files:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">image_width</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">image_height</span> <span class="o">=</span> <span class="mi">28</span>

<span class="n">characters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">)</span> <span class="c1"># Characters to consider, ignoring symbols
</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">csv_dataset_folder</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="s">"google_fonts_dataset.csv"</span><span class="p">,</span> <span class="s">'w'</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s">''</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">writer</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">"excel"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">font_file</span> <span class="ow">in</span> <span class="n">ttf_files</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">font_file</span><span class="p">)</span>

        <span class="n">font_name</span> <span class="o">=</span> <span class="n">font_file</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"/"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="p">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">font_file</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"unic"</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">characters</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s">'L'</span><span class="p">,</span> <span class="p">(</span><span class="n">image_width</span><span class="p">,</span><span class="n">image_height</span><span class="p">),</span> <span class="s">"black"</span><span class="p">)</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="p">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
            <span class="n">text_width</span><span class="p">,</span> <span class="n">text_height</span> <span class="o">=</span> <span class="n">draw</span><span class="p">.</span><span class="n">textsize</span><span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>

            <span class="n">offset</span> <span class="o">=</span> <span class="n">font</span><span class="p">.</span><span class="n">getoffset</span><span class="p">(</span><span class="n">character</span><span class="p">)</span>

            <span class="n">draw</span><span class="p">.</span><span class="n">text</span><span class="p">(</span>
                <span class="p">((</span><span class="n">image_width</span><span class="o">-</span><span class="p">(</span><span class="n">text_width</span><span class="o">+</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">/</span><span class="mi">2</span><span class="p">,(</span><span class="n">image_height</span><span class="o">-</span><span class="p">(</span><span class="n">text_height</span><span class="o">+</span><span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                <span class="n">character</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="s">'white'</span><span class="p">,</span>
                <span class="n">font</span><span class="o">=</span><span class="n">font</span>
            <span class="p">)</span>

            <span class="n">row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">getdata</span><span class="p">())</span>
            <span class="n">row</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">character</span><span class="p">)</span>
            <span class="n">row</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">font_name</span><span class="p">)</span>

            <span class="n">writer</span><span class="p">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">character</span><span class="p">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="n">image</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">dataset_dir</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">images_dir</span> <span class="o">+</span> <span class="s">f"/</span><span class="si">{</span><span class="n">font_name</span><span class="si">}</span><span class="s">-upper-</span><span class="si">{</span><span class="n">character</span><span class="si">}</span><span class="s">.png"</span><span class="p">,</span> <span class="s">"PNG"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">image</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">dataset_dir</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">images_dir</span> <span class="o">+</span> <span class="s">f"/</span><span class="si">{</span><span class="n">font_name</span><span class="si">}</span><span class="s">-</span><span class="si">{</span><span class="n">character</span><span class="si">}</span><span class="s">.png"</span><span class="p">,</span> <span class="s">"PNG"</span><span class="p">)</span>
</code></pre></div></div>

    </content>

    <side style="font-size: 0.9em">
      <h3 style="margin-bottom: 1em">Notes mentioning this note</h3>


      <div style="font-size: 0.9em">
        <p>
          There are no notes linking to this note.
        </p>
      </div>

    </side>
  </div>
</article>

<hr>

<!-- Uncomment the following lines to enable the graph  -->
<!-- <p>Here are all the notes in this garden, along with their links, visualized as a graph.</p>

<style>
  .links line {
    stroke: #ccc;
    opacity: 0.5;
  }

  .nodes circle {
    cursor: pointer;
    fill: blue;
    transition: all 0.15s ease-out;
  }

  .text text {
    cursor: pointer;
    fill: #333;
    text-shadow: -1px -1px 0 #fafafabb, 1px -1px 0 #fafafabb, -1px 1px 0 #fafafabb, 1px 1px 0 #fafafabb;
  }

  .nodes [active],
  .text [active] {
    cursor: pointer;
    fill: red;
  }

  .nodes circle[active] {
    r: 6;
  }

  #graph-wrapper {
    background: #fafafa;
    border-radius: 4px;
    height: auto;
  }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
  integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
  crossorigin="anonymous"></script>

<div id="graph-wrapper">
  <script>
    const RADIUS = 4;
    const STROKE = 1;
    const FONT_SIZE = 15;
    const TICKS = 100;
    const FONT_BASELINE = 15;
    const MAX_LABEL_LENGTH = 50;

    const graphData = {"edges":[],"nodes":[{"id":"626194391","path":"/action-is-better","label":"Action is harder but better than reading"},{"id":"1152671","path":"/atlas-oss","label":"Open sourcing Atlas - tools for Applied Deep Learning Development"},{"id":"48628282740514077","path":"/datacouncil-talk","label":"Datacouncil NYC 19' Talk"},{"id":"2221370068514","path":"/distraction-time","label":"Schedule personal distraction time to be able to deep work effectively"},{"id":"72674812227479","path":"/precision-recall","label":"Precision vs. Recall"},{"id":"84531860657236","path":"/typeface-dataset","label":"Typefaces - Character Font Image & CSV Dataset"},{"id":"145227769665069534892","path":"/understanding-ml-sets","label":"Understanding True Positives, False Positives, True Negatives & False Negatives"},{"id":"2569390390423852","path":"/uoft","label":"Partnering with University of Toronto - CSC 454 - The business of software"}]}

    let nodesData = graphData.nodes;
    let linksData = graphData.edges;

    const onClick = (d) => {
      window.location = d.path
    };

    const element = document.createElementNS(
      "http://www.w3.org/2000/svg",
      "svg"
    );
    const graphWrapper = document.getElementById('graph-wrapper')

    element.setAttribute("width", graphWrapper.getBoundingClientRect().width);
    graphWrapper.setAttribute("height", window.innerHeight * 0.8);
    element.setAttribute("height", window.innerHeight * 0.8);

    graphWrapper.appendChild(element);

    const reportWindowSize = () => {
      element.setAttribute("width", graphWrapper.getBoundingClientRect().width);
      graphWrapper.setAttribute("height", window.innerHeight * 0.8);
      element.setAttribute("height", window.innerHeight * 0.8);
    };

    window.onresize = reportWindowSize;

    const svg = d3.select("svg");
    const width = Number(svg.attr("width"));
    const height = Number(svg.attr("height"));
    let zoomLevel = 1;

    const simulation = d3
      .forceSimulation(nodesData)
      .force("charge", d3
        .forceManyBody()
        .strength(-4000)
      )
      .force(
        "link",
        d3
          .forceLink(linksData)
          .id((d) => d.id)
          .distance(150)
      )
      .force("center", d3.forceCenter(width / 2, height / 2))
      .stop();

    const g = svg.append("g");
    let link = g.append("g").attr("class", "links").selectAll(".link");
    let node = g.append("g").attr("class", "nodes").selectAll(".node");
    let text = g.append("g").attr("class", "text").selectAll(".text");

    const zoomActions = () => {
      const scale = d3.event.transform;
      zoomLevel = scale.k;
      g.attr("transform", scale);

      const zoomOrKeep = (value) => (scale.k >= 1 ? value / scale.k : value);

      const font = Math.max(Math.round(zoomOrKeep(FONT_SIZE)), 1);

      text.attr("font-size", `${font}px`);
      text.attr("y", (d) => d.y - zoomOrKeep(FONT_BASELINE));
      link.attr("stroke-width", zoomOrKeep(STROKE));
      node.attr("r", zoomOrKeep(RADIUS));
    };

    const ticked = () => {
      node.attr("cx", (d) => d.x).attr("cy", (d) => d.y);
      text
        .attr("x", (d) => d.x)
        .attr("y", (d) => d.y - FONT_BASELINE / zoomLevel);
      link
        .attr("x1", (d) => d.source.x)
        .attr("y1", (d) => d.source.y)
        .attr("x2", (d) => d.target.x)
        .attr("y2", (d) => d.target.y);
    };

    const restart = () => {
      node = node.data(nodesData, (d) => d.id);
      node.exit().remove();
      node = node
        .enter()
        .append("circle")
        .attr("r", RADIUS)
        // .attr("fill", (d) => getNodeColor(d))
        .on("click", onClick)
        .merge(node);

      link = link.data(linksData, (d) => `${d.source.id}-${d.target.id}`);
      link.exit().remove();
      link = link
        .enter()
        .append("line")
        .attr("stroke-width", STROKE)
        .merge(link);

      node.attr("active", (d) => isCurrentPath(d.path) ? true : null);
      text.attr("active", (d) => isCurrentPath(d.path) ? true : null);

      text = text.data(nodesData, (d) => d.label);
      text.exit().remove();
      text = text
        .enter()
        .append("text")
        .text((d) => shorten(d.label.replace(/_*/g, ""), MAX_LABEL_LENGTH))
        .attr("font-size", `${FONT_SIZE}px`)
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .on("click", onClick)
        .merge(text);

      simulation.nodes(nodesData);
      simulation.force("link").links(linksData);
      simulation.alpha(1).restart();
      simulation.stop();

      for (let i = 0; i < TICKS; i++) {
        simulation.tick();
      }

      ticked();
    };

    const zoomHandler = d3
      .zoom()
      .scaleExtent([0.2, 3])
      //.translateExtent([[0,0], [width, height]])
      //.extent([[0, 0], [width, height]])
      .on("zoom", zoomActions);

    zoomHandler(svg);
    restart();

    function isCurrentPath(notePath) {
      return window.location.pathname.includes(notePath)
    }

    function shorten(str, maxLen, separator = ' ') {
      if (str.length <= maxLen) return str;
      return str.substr(0, str.lastIndexOf(separator, maxLen)) + '...';
    }
  </script>
</div>
 -->
</main>
      <footer>Find me on <b><a class="internal-link" href="https://twitter.com/mohammedri_">Twitter</a>!</b>
</footer>
    </div>

    <!-- That file is not particularly elegant. This will need a refactor at some point. -->
<style>
  content a.internal-link {
    border-color: #8b88e6;
  }

  #tooltip-wrapper {
    background: white;
    padding: 1em;
    border: 1px solid #ddd;
    border-radius: 4px;
    overflow: hidden;
    position: absolute;
    width: 400px;
    height: 250px;
    font-size: 0.8em;
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    opacity: 0;
    transition: opacity 100ms;
  }

  #tooltip-wrapper:after {
		content: "";
		position: absolute;
		z-index: 1;
		bottom: 0;
		left: 0;
		pointer-events: none;
		background-image: linear-gradient(to bottom, rgba(255,255,255, 0), rgba(255,255,255, 1) 90%);
		width: 100%;
		height: 75px;
  }
</style>

<div style="opacity: 0; display: none;" id='tooltip-wrapper'>
  <div id='tooltip-content'>
  </div>
</div>

<iframe style="display: none; height: 0; width: 0;" id='link-preview-iframe' src="">
</iframe>

<script>
  var opacityTimeout;
  var contentTimeout;
  var transitionDurationMs = 100;

  var iframe = document.getElementById('link-preview-iframe')
  var tooltipWrapper = document.getElementById('tooltip-wrapper')
  var tooltipContent = document.getElementById('tooltip-content')

  function hideTooltip() {
    opacityTimeout = setTimeout(function() {
      tooltipWrapper.style.opacity = 0;
      contentTimeout = setTimeout(function() {
        tooltipContent.innerHTML = '';
        tooltipWrapper.style.display = 'none';
      }, transitionDurationMs + 1);
    }, transitionDurationMs)
  }

  function showTooltip(event) {
    var elem = event.target;
    var elem_props = elem.getClientRects()[elem.getClientRects().length - 1];
    var top = window.pageYOffset || document.documentElement.scrollTop

    if (event.target.host === window.location.host) {
      iframe.src = event.target.href
      iframe.onload = function() {
        tooltipContentHtml = ''
        tooltipContentHtml += '<div style="font-weight: bold;">' + iframe.contentWindow.document.querySelector('h1').innerHTML + '</div>'
        tooltipContentHtml += iframe.contentWindow.document.querySelector('content').innerHTML

        tooltipContent.innerHTML = tooltipContentHtml

        tooltipWrapper.style.display = 'block';
        setTimeout(function() {
          tooltipWrapper.style.opacity = 1;
        }, 1)
      }

      tooltipWrapper.style.left = elem_props.left - (tooltipWrapper.offsetWidth / 2) + (elem_props.width / 2) + "px";
      if ((window.innerHeight - elem_props.top) < (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top - tooltipWrapper.offsetHeight - 10 + "px";
      } else if ((window.innerHeight - elem_props.top) > (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top + 35 + "px";
      }

      if ((elem_props.left + (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = "10px";
      } else if ((document.body.clientWidth - elem_props.left - (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = document.body.clientWidth - tooltipWrapper.offsetWidth - 20 + "px";
      }
    }
  }

  function setupListeners(linkElement) {
    linkElement.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
      showTooltip(event);
    });

    tooltipWrapper.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
    });
  }

  document.querySelectorAll('content a').forEach(setupListeners);
</script>

  </body>
</html>
